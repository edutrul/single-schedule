<html>


<meta http-equiv="refresh" content="5"/>

<style>
  @font-face {
    font-family: minecraft;
    src: url(minecraft-font.ttf);
  }
  body {
    cursor: pointer;
    color: white;
    font-family: minecraft;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-size: calc(4em + 1vw);
    background-image: url("minecraft_library.jpg");
    background-repeat: no-repeat;
    background-size: cover;
    background-position: center;
  }
  .headline {
    position: relative;
    padding: 10%;
    z-index: 1;
  }
  .rectangle {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: -1;
    background-color: black;
    opacity: 0.6;
  }
  p {
    margin: 0%;
  }
  #course_title {
    margin: 4% 0% 0% 0%;
    opacity: 1;
  }
</style>

<body>

<div class="headline"><p id="headline">Es hora del curso: </p><br>
  <div class="rectangle"></div>
  <p id="course_title">{{ curso_value }}</p>
</div>

<script>
  // lw means "Life with Whole Group".
  // lg means "Life with Group".
  //
  let schedules = [
    {
      // Simulating this is monday.
      "day": "monday",
      "details": [
        {
          "title": "Permanents and Mindfulness",
          "start_hour": "08:00",
          "end_hour": "08:30",
          "type_hour": "am",
          "group": ["a", "b"],
          "class_type": "lw",
          // @TODO: Update this link.
          "uri": "https://meet.google.com/zic-atxk-omn",
          // @TODO: Here goes a course image uri.
          // "image_uri": "https://example.com/image.png"
        },
        {
          "title": "Physical Education",
          "start_hour": "8:30",
          "end_hour": "9:00",
          "type_hour": "am",
          "group": ["a", "b"],
          // @TODO: Update this link.
          "uri": "https://meet.google.com/zic-atxk-omn",
          "class_type": "lw",
          // @TODO: Here goes a course image uri.
          // "image_uri": "https://example.com/image.png"
        },
        {
          "title": "Break",
          "start_hour": "9:00",
          "end_hour": "9:15",
          "type_hour": "am",
          "group": ["a", "b"],
          "uri": "",
          "class_type": "lw",
        },
        {
          "title": "Arte",
          "start_hour": "9:15",
          "end_hour": "9:35",
          "type_hour": "am",
          "group": ["a"],
          "uri": "https://meet.google.com/apk-zpoc-grg",
          "class_type": "lg",
        },
        {
          "title": "Tutoría",
          "start_hour": "9:40",
          "end_hour": "10:00",
          "type_hour": "am",
          "group": ["a"],
          "uri": "https://meet.google.com/apk-zpoc-grg",
          "class_type": "lg",
        },
        {
          "title": "Arte",
          "start_hour": "9:15",
          "end_hour": "9:35",
          "type_hour": "am",
          "group": ["b"],
          "uri": "https://meet.google.com/aqf-crbt-kfo",
          "class_type": "lg",
        },
        {
          "title": "Tutoría",
          "start_hour": "9:40",
          "end_hour": "10:00",
          "type_hour": "am",
          "group": ["b"],
          "uri": "https://meet.google.com/aqf-crbt-kfo",
          "class_type": "lg",
        },
        {
          "title": "Math",
          "start_hour": "10:00",
          "end_hour": "10:45",
          "type_hour": "am",
          "group": ["a"],
          "uri": "https://meet.google.com/apk-zpoc-grg",
          "class_type": "lg",
        },
        {
          "title": "Math",
          "start_hour": "10:00",
          "end_hour": "10:45",
          "type_hour": "am",
          "group": ["b"],
          "uri": "https://meet.google.com/aqf-crbt-kfo",
          "class_type": "lg",
        }
      ]
    },
    {
      // Simulating this is tuesday.
      "day": "tuesday",
      "details": [
        {
          "title": "Permanents and Mindfulness",
          "start_hour": "11:00",
          "end_hour": "11:30",
          "type_hour": "am",
          "group": ["a", "b"],
          "class_type": "lw",
          // @TODO: Update this link.
          "uri": "https://meet.google.com/zic-atxk-omn?hs=122&authuser=2,",
          // @TODO: Here goes a course image uri.
          // "image_uri": "https://example.com/image.png"
        },
        {
          "title": "Physical Education",
          "start_hour": "8:00",
          "end_hour": "8:30",
          "type_hour": "am",
          "group": ["a", "b"],
          // @TODO: Update this link.
          "uri": "https://meet.google.com/zic-atxk-omn",
          "class_type": "lw",
          // @TODO: Here goes a course image uri.
          // "image_uri": "https://example.com/image.png"
        },
        {
          "title": "Break",
          "start_hour": "9:00",
          "end_hour": "9:15",
          "type_hour": "am",
          "group": ["a", "b"],
          "uri": "",
          "class_type": "lw",
        },
        {
          "title": "Arte",
          "start_hour": "9:15",
          "end_hour": "9:35",
          "type_hour": "am",
          "group": ["a"],
          "uri": "https://meet.google.com/apk-zpoc-grg",
          "class_type": "lg",
        },
        {
          "title": "Tutoría",
          "start_hour": "9:40",
          "end_hour": "10:00",
          "type_hour": "am",
          "group": ["a"],
          "uri": "https://meet.google.com/apk-zpoc-grg",
          "class_type": "lg",
        },
        {
          "title": "Arte",
          "start_hour": "9:15",
          "end_hour": "9:35",
          "type_hour": "am",
          "group": ["b"],
          "uri": "https://meet.google.com/aqf-crbt-kfo",
          "class_type": "lg",
        },
        {
          "title": "Tutoría",
          "start_hour": "9:40",
          "end_hour": "10:00",
          "type_hour": "am",
          "group": ["b"],
          "uri": "https://meet.google.com/aqf-crbt-kfo",
          "class_type": "lg",
        },
        {
          "title": "Math",
          "start_hour": "10:00",
          "end_hour": "10:45",
          "type_hour": "am",
          "group": ["a"],
          "uri": "https://meet.google.com/apk-zpoc-grg",
          "class_type": "lg",
        },
        {
          "title": "Math",
          "start_hour": "10:00",
          "end_hour": "10:45",
          "type_hour": "am",
          "group": ["b"],
          "uri": "https://meet.google.com/aqf-crbt-kfo",
          "class_type": "lg",
        }
      ]
    }
  ];

  console.log(schedules);
  let days = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday'];
  let d = new Date();
  console.log("new Date()");
  console.log(d);
  let hour = d.getHours();
  console.log("hour");
  console.log(hour);
  let minutes = (d.getMinutes() < 10 ? '0' : '') + d.getMinutes();
  console.log("minutes");
  console.log(minutes);
  let string_current_hour_minutes = `${hour}:${minutes}`;
  let int_current_hour_minutes = parseInt(`${hour}${minutes}`);
  console.log('int_current_hour_minutes: ');
  console.log(int_current_hour_minutes);
  console.log('string_current_hour_minutes: ');
  console.log(string_current_hour_minutes);
  let day_name = days[d.getDay()];
  console.log(day_name);

  // @TODO: Add defensive programming.
  let day_details = schedules.filter(s => s.day === day_name)[0].details;
  console.log(day_details);
  let course_arr = day_details.filter(
    c => int_current_hour_minutes >= parseInt(c.start_hour.replace(":", ""))  &&
      int_current_hour_minutes <= parseInt(c.end_hour.replace(":", ""))
  );
  // @TODO: Add defensive programming.
  if (course_arr[0]) {
    let course = course_arr[0];
    console.log('course');
    console.log(course);
    document.body.onclick = () => window.open(course.uri, '_blank').focus();
    //let meeting_uri = course.uri;
    console.log("Course found:");
    console.log(course.title);
    document.getElementById("course_title").innerHTML = course.title;
    // @TODO: Update programmatically image uri based on the course.
    // var div = document.getElementById("div1");
    // div.style.marginTop = ".25in";
    //course_title_el.innerHTML = "hel";
  }
  else {
    document.getElementById("headline").innerHTML = "GAME OVER";
    document.getElementById("course_title").innerHTML = "No ha iniciado el curso AUN";
    document.body.style.backgroundImage = "url('minecraft_game_over.jpg')";
    console.log("No ha iniciado el curso");
  }


  function openInNewTab(url) {
    var win = window.open(url, '_blank');
    win.focus();
  }
</script>

</body>





</html>

